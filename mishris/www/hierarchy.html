{% extends "templates/web.html" %}

{% block title %}Hierarchy{% endblock %}
{% block page_sidebar %}
{% include "templates/pages/web_sidebar.html" %}
{% endblock %}
{% block page_content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.2/css/jquery.orgchart.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.2/css/jquery.orgchart.min.css">

    <style>
        #chart-container {
            font-family: Arial;
            height: 420px;
            border: 2px dashed #aaa;
            border-radius: 5px;
            overflow: auto;
            text-align: center;
        }

    </style>

    <div id="chart-container"></div>       
    {{employee}}


    
    <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.3/js/jquery.orgchart.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.3/js/jquery.orgchart.min.js.map"></script>

    <script>
        // var ds = {};
        // frappe.ready(function(){
            
        //     frappe.call({
        //         method: "frappe.client.get_list",
        //         args: {
        //             doctype: "Employee",
        //             filters: [],
        //             fields: ["employee_name", "designation", "reports_to"]
        //         },
        //         callback: function(r){
        //             // employee = r.message;
        //             if(r.message){
        //                 (function($) {
        //                     $(function() {
        //                         ds = r.message;
        //                         console.log("1", ds)
        //                         var oc = $('#chart-container').orgchart({
        //                         'data' : ds,
        //                         'depth': 2,
        //                         'nodeContent': 'title'
        //                         });
                                
        //                         $('#chart-container').find('.node').on('click', function () {
        //                         alert(JSON.stringify($(this).data('nodeData')));
        //                         });

        //                     });
        //                     })(jQuery);
        //             }
        //         }
        //     })
            
        // })
        
        var ds = 
        {
            'name': 'Lao Lao',
            'title': 'general manager',
            'children': [
            { 'name': 'Bo Miao', 'title': 'department manager' },
            { 'name': 'Su Miao', 'title': 'department manager',
                'children': [
                { 'name': 'Tie Hua', 'title': 'senior engineer' },
                { 'name': 'Hei Hei', 'title': 'senior engineer',
                    'children': [
                    { 'name': 'Pang Pang', 'title': 'engineer' },
                    { 'name': 'Xiang Xiang', 'title': 'UE engineer' }
                    ]
                    }
                ]
                },
                { 'name': 'Hong Miao', 'title': 'department manager' },
                { 'name': 'Chun Miao', 'title': 'department manager' }
            ]
        };
        
        (function($) {
            $(function() {
                // ds = r.message;
                // console.log(ds)
                var oc = $('#chart-container').orgchart({
                'data' : ds,
                'depth': 2,
                'nodeContent': 'title'
                });
                
                $('#chart-container').find('.node').on('click', function () {
                alert(JSON.stringify($(this).data('nodeData')));
                });

            });
        })(jQuery);
        
    </script>
{% endblock%}

